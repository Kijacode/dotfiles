var app=function(){"use strict";function t(){}function n(t,n){for(const e in n)t[e]=n[e];return t}function e(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(e)}function c(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function l(t,n){t.appendChild(n)}function s(t,n,e){t.insertBefore(n,e||null)}function a(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function h(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function m(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}let v;function g(t){v=t}function $(t){(function(){if(!v)throw new Error("Function called outside component initialization");return v})().$$.on_mount.push(t)}const y=[],b=[],w=[],x=[],_=Promise.resolve();let k=!1;function C(t){w.push(t)}let z=!1;const E=new Set;function A(){if(!z){z=!0;do{for(let t=0;t<y.length;t+=1){const n=y[t];g(n),U(n.$$)}for(g(null),y.length=0;b.length;)b.pop()();for(let t=0;t<w.length;t+=1){const n=w[t];E.has(n)||(E.add(n),n())}w.length=0}while(y.length);for(;x.length;)x.pop()();k=!1,z=!1,E.clear()}}function U(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(C)}}const M=new Set;let j;function N(){j={r:0,c:[],p:j}}function S(){j.r||r(j.c),j=j.p}function B(t,n){t&&t.i&&(M.delete(t),t.i(n))}function L(t,n,e,o){if(t&&t.o){if(M.has(t))return;M.add(t),j.c.push((()=>{M.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}function O(t,n,o){const{fragment:i,on_mount:l,on_destroy:s,after_update:a}=t.$$;i&&i.m(n,o),C((()=>{const n=l.map(e).filter(c);s?s.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(C)}function P(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function T(t,n){-1===t.$$.dirty[0]&&(y.push(t),k||(k=!0,_.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function q(n,e,c,i,l,s,u=[-1]){const f=v;g(n);const d=e.props||{},p=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:o(),dirty:u,skip_bound:!1};let h=!1;if(p.ctx=c?c(n,d,((t,e,...o)=>{const r=o.length?o[0]:e;return p.ctx&&l(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),h&&T(n,t)),e})):[],p.update(),h=!0,r(p.before_update),p.fragment=!!i&&i(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(a)}else p.fragment&&p.fragment.c();e.intro&&B(n.$$.fragment),O(n,e.target,e.anchor),A()}g(f)}class F{$destroy(){P(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function D(t){let n,e,o,r;return{c(){n=u("div"),e=u("img"),h(e,"alt",o=t[2]+"-flair"),e.src!==(r=flairMap[t[2]])&&h(e,"src",r),h(e,"class","svelte-povlee"),h(n,"class","flair svelte-povlee")},m(t,o){s(t,n,o),l(n,e)},p(t,n){4&n&&o!==(o=t[2]+"-flair")&&h(e,"alt",o),4&n&&e.src!==(r=flairMap[t[2]])&&h(e,"src",r)},d(t){t&&a(n)}}}function G(n){let e,o,r,i,v,g,$,y,b,w,x,_=n[1].slice(0,8)+"",k=n[2]&&n[2]in flairMap&&D(n);return{c(){e=u("div"),o=u("div"),r=u("img"),v=d(),g=u("div"),$=u("div"),y=f(_),b=d(),k&&k.c(),h(r,"alt","avatar"),r.src!==(i=n[0])&&h(r,"src",i),h(r,"class","svelte-povlee"),h(o,"class","avatar has-story svelte-povlee"),h($,"class","svelte-povlee"),h(g,"class","name-container svelte-povlee"),h(e,"class","unit svelte-povlee")},m(t,i){s(t,e,i),l(e,o),l(o,r),l(e,v),l(e,g),l(g,$),l($,y),l(g,b),k&&k.m(g,null),w||(x=p(e,"click",(function(){c(n[3])&&n[3].apply(this,arguments)})),w=!0)},p(t,[e]){n=t,1&e&&r.src!==(i=n[0])&&h(r,"src",i),2&e&&_!==(_=n[1].slice(0,8)+"")&&m(y,_),n[2]&&n[2]in flairMap?k?k.p(n,e):(k=D(n),k.c(),k.m(g,null)):k&&(k.d(1),k=null)},i:t,o:t,d(t){t&&a(e),k&&k.d(),w=!1,x()}}}function H(t,n,e){let{creatorAvatarUrl:o}=n,{creatorUsername:r}=n,{flair:c}=n,{onClick:i}=n;return t.$$set=t=>{"creatorAvatarUrl"in t&&e(0,o=t.creatorAvatarUrl),"creatorUsername"in t&&e(1,r=t.creatorUsername),"flair"in t&&e(2,c=t.flair),"onClick"in t&&e(3,i=t.onClick)},[o,r,c,i]}class I extends F{constructor(t){super(),q(this,t,H,G,i,{creatorAvatarUrl:0,creatorUsername:1,flair:2,onClick:3})}}function J(t,n,e){const o=t.slice();return o[9]=n[e],o}function K(t){let n,e,o,r,c=t[1],i=[];for(let n=0;n<c.length;n+=1)i[n]=V(J(t,c,n));const l=t=>L(i[t],1,1,(()=>{i[t]=null}));let p=t[2]&&W(t);return{c(){n=u("div");for(let t=0;t<i.length;t+=1)i[t].c();e=d(),p&&p.c(),o=f(""),h(n,"class","story-grid svelte-1h4owzz")},m(t,c){s(t,n,c);for(let t=0;t<i.length;t+=1)i[t].m(n,null);s(t,e,c),p&&p.m(t,c),s(t,o,c),r=!0},p(t,e){if(2&e){let o;for(c=t[1],o=0;o<c.length;o+=1){const r=J(t,c,o);i[o]?(i[o].p(r,e),B(i[o],1)):(i[o]=V(r),i[o].c(),B(i[o],1),i[o].m(n,null))}for(N(),o=c.length;o<i.length;o+=1)l(o);S()}t[2]?p?p.p(t,e):(p=W(t),p.c(),p.m(o.parentNode,o)):p&&(p.d(1),p=null)},i(t){if(!r){for(let t=0;t<c.length;t+=1)B(i[t]);r=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)L(i[t]);r=!1},d(t){t&&a(n),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(i,t),t&&a(e),p&&p.d(t),t&&a(o)}}}function Q(n){let e;return{c(){e=u("p"),e.textContent="loading stories..."},m(t,n){s(t,e,n)},p:t,i:t,o:t,d(t){t&&a(e)}}}function R(n){let e,o,r,c=n[3].message+"";return{c(){e=u("p"),o=f("An error has occured: "),r=f(c)},m(t,n){s(t,e,n),l(e,o),l(e,r)},p(t,n){8&n&&c!==(c=t[3].message+"")&&m(r,c)},i:t,o:t,d(t){t&&a(e)}}}function V(t){let e,o;function r(...n){return t[5](t[9],...n)}const c=[{onClick:r},t[9]];let i={};for(let t=0;t<c.length;t+=1)i=n(i,c[t]);return e=new I({props:i}),{c(){var t;(t=e.$$.fragment)&&t.c()},m(t,n){O(e,t,n),o=!0},p(n,o){t=n;const i=2&o?function(t,n){const e={},o={},r={$$scope:1};let c=t.length;for(;c--;){const i=t[c],l=n[c];if(l){for(const t in i)t in l||(o[t]=1);for(const t in l)r[t]||(e[t]=l[t],r[t]=1);t[c]=l}else for(const t in i)r[t]=1}for(const t in o)t in e||(e[t]=void 0);return e}(c,[{onClick:r},2&o&&(l=t[9],"object"==typeof l&&null!==l?l:{})]):{};var l;e.$set(i)},i(t){o||(B(e.$$.fragment,t),o=!0)},o(t){L(e.$$.fragment,t),o=!1},d(t){P(e,t)}}}function W(t){let n,e,o,r;function c(t,n){return"more"===t[0]?Y:X}let i=c(t),l=i(t);return{c(){n=u("button"),l.c(),n.disabled=e="ready"!==t[0],h(n,"class","svelte-1h4owzz")},m(e,c){s(e,n,c),l.m(n,null),o||(r=p(n,"click",t[6]),o=!0)},p(t,o){i!==(i=c(t))&&(l.d(1),l=i(t),l&&(l.c(),l.m(n,null))),1&o&&e!==(e="ready"!==t[0])&&(n.disabled=e)},d(t){t&&a(n),l.d(),o=!1,r()}}}function X(t){let n;return{c(){n=f("load more")},m(t,e){s(t,n,e)},d(t){t&&a(n)}}}function Y(t){let n,e,o,r;return{c(){n=f("loading"),e=u("span"),e.textContent=".",o=u("span"),o.textContent=".",r=u("span"),r.textContent=".",h(e,"class","one svelte-1h4owzz"),h(o,"class","two svelte-1h4owzz"),h(r,"class","three svelte-1h4owzz")},m(t,c){s(t,n,c),s(t,e,c),s(t,o,c),s(t,r,c)},d(t){t&&a(n),t&&a(e),t&&a(o),t&&a(r)}}}function Z(t){let n,e,o,r;const c=[R,Q,K],i=[];function l(t,n){return t[3]?0:"initial"===t[0]||"refetch"===t[0]?1:2}return e=l(t),o=i[e]=c[e](t),{c(){n=u("main"),o.c()},m(t,o){s(t,n,o),i[e].m(n,null),r=!0},p(t,[r]){let s=e;e=l(t),e===s?i[e].p(t,r):(N(),L(i[s],1,1,(()=>{i[s]=null})),S(),o=i[e],o||(o=i[e]=c[e](t),o.c()),B(o,1),o.m(n,null))},i(t){r||(B(o),r=!0)},o(t){L(o),r=!1},d(t){t&&a(n),i[e].d()}}}function tt(t,n,e){var o=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(r,c){function i(t){try{s(o.next(t))}catch(t){c(t)}}function l(t){try{s(o.throw(t))}catch(t){c(t)}}function s(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(i,l)}s((o=o.apply(t,n||[])).next())}))};let r="initial",c=0;const i=()=>o(void 0,void 0,void 0,(function*(){try{const t=yield fetch(apiBaseUrl+"/text-stories/hot"+(c?"/"+c:"")),n=yield t.json(),o=new Set,i=[];"refetch"!==r&&l.forEach((t=>{i.push(t),o.add(t.id)}));for(const t of n.stories)o.has(t.id)||(i.push(t),o.add(t.id));e(1,l=i),e(2,s=n.hasMore),c++}catch(t){e(3,a=t)}e(0,r="ready")}));let l=[],s=!1,a=null;$((()=>o(void 0,void 0,void 0,(function*(){yield i()})))),window.addEventListener("message",(t=>{const n=t.data;switch(n.command){case"new-story":l.every((t=>t.id!==n.story.id))&&e(1,l=[n.story,...l]);break;case"refresh":"ready"===r&&(c=0,e(0,r="refetch"),i())}}));return[r,l,s,a,i,t=>{tsvscode.postMessage({type:"onStoryPress",value:t})},()=>{e(0,r="more"),i()}]}return new class extends F{constructor(t){super(),q(this,t,tt,Z,i,{})}}({target:document.body})}();
//# sourceMappingURL=sidebar.js.map
